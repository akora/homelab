# n8n Environment Configuration
# This file is managed by Ansible - local changes will be overwritten

# Base URL configuration
N8N_HOST={{ n8n_domain }}
N8N_PROTOCOL={{ n8n_protocol }}
N8N_PORT={{ n8n_http_port }}
N8N_PATH=/

# Webhook URL configuration
# This ensures webhooks use the external domain without port numbers
WEBHOOK_URL={{ n8n_root_url }}

# Security configuration
N8N_BASIC_AUTH_ACTIVE=true
N8N_BASIC_AUTH_USER={{ n8n_basic_auth_user }}
N8N_BASIC_AUTH_PASSWORD={{ n8n_basic_auth_password }}
N8N_ENCRYPTION_KEY={{ n8n_encryption_key }}

# General configuration
N8N_LOG_LEVEL=info
GENERIC_TIMEZONE={{ n8n_timezone }}

# Proxy configuration
# Setting proxy hops to 1 for Traefik reverse proxy
# This fixes the express-rate-limit X-Forwarded-For validation error
N8N_PROXY_HOPS=1

# Execution settings
EXECUTIONS_MODE=regular
EXECUTIONS_TIMEOUT=3600
EXECUTIONS_TIMEOUT_MAX=7200
EXECUTIONS_DATA_SAVE_ON_ERROR=all
EXECUTIONS_DATA_SAVE_ON_SUCCESS=all
EXECUTIONS_DATA_SAVE_ON_PROGRESS=true
EXECUTIONS_DATA_SAVE_MANUAL_EXECUTIONS=true

# Workflow settings
WORKFLOW_CALLERS_ENABLE=true
WORKFLOW_CALLERS_TIMEOUT=3600

# Security settings
N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS=true

# Enable task runners (recommended by n8n)
N8N_RUNNERS_ENABLED=true
